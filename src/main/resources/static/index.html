<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediTrack — Medical Practice Management</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #2563eb; --primary-dark: #1d4ed8; --success: #16a34a;
            --danger: #dc2626; --warning: #f59e0b; --bg: #f8fafc;
            --card: #ffffff; --text: #1e293b; --muted: #64748b;
            --border: #e2e8f0; --radius: 12px;
        }
        body { font-family: 'Segoe UI', system-ui, -apple-system, sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; }
        
        /* Navigation */
        .navbar { background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; padding: 1rem 2rem; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .navbar h1 { font-size: 1.5rem; font-weight: 700; }
        .navbar .stats { font-size: 0.85rem; opacity: 0.9; }
        
        /* Layout */
        .container { max-width: 1200px; margin: 0 auto; padding: 1.5rem; }
        .tabs { display: flex; gap: 0.5rem; margin-bottom: 1.5rem; flex-wrap: wrap; }
        .tab { padding: 0.6rem 1.2rem; border: 2px solid var(--border); border-radius: var(--radius); cursor: pointer; background: var(--card); font-weight: 500; transition: all 0.2s; }
        .tab:hover { border-color: var(--primary); color: var(--primary); }
        .tab.active { background: var(--primary); color: white; border-color: var(--primary); }
        
        .panel { display: none; }
        .panel.active { display: block; }
        
        /* Cards & Forms */
        .card { background: var(--card); border-radius: var(--radius); padding: 1.5rem; box-shadow: 0 1px 3px rgba(0,0,0,0.08); border: 1px solid var(--border); margin-bottom: 1rem; }
        .card h3 { margin-bottom: 1rem; color: var(--primary); }
        
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.8rem; margin-bottom: 1rem; }
        label { display: block; font-size: 0.8rem; font-weight: 600; color: var(--muted); margin-bottom: 0.25rem; text-transform: uppercase; letter-spacing: 0.5px; }
        input, select, textarea { width: 100%; padding: 0.6rem 0.8rem; border: 2px solid var(--border); border-radius: 8px; font-size: 0.9rem; transition: border-color 0.2s; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: var(--primary); }
        
        .btn { padding: 0.6rem 1.2rem; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.85rem; transition: all 0.2s; display: inline-flex; align-items: center; gap: 0.4rem; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-dark); }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-warning { background: var(--warning); color: white; }
        .btn-sm { padding: 0.35rem 0.8rem; font-size: 0.8rem; }
        
        .actions { display: flex; gap: 0.5rem; margin-top: 1rem; flex-wrap: wrap; }
        
        /* Table */
        table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
        th { background: var(--bg); padding: 0.7rem; text-align: left; font-weight: 600; color: var(--muted); text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.5px; border-bottom: 2px solid var(--border); }
        td { padding: 0.7rem; border-bottom: 1px solid var(--border); }
        tr:hover { background: #f1f5f9; }
        
        .badge { padding: 0.2rem 0.6rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }
        .badge-confirmed { background: #dcfce7; color: #166534; }
        .badge-pending { background: #fef3c7; color: #92400e; }
        .badge-cancelled { background: #fee2e2; color: #991b1b; }
        .badge-completed { background: #dbeafe; color: #1e40af; }
        
        /* Stats */
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
        .stat-card { background: var(--card); border-radius: var(--radius); padding: 1.2rem; border: 1px solid var(--border); text-align: center; }
        .stat-card .number { font-size: 2rem; font-weight: 700; color: var(--primary); }
        .stat-card .label { font-size: 0.8rem; color: var(--muted); margin-top: 0.25rem; }
        
        .toast { position: fixed; top: 1rem; right: 1rem; padding: 0.8rem 1.2rem; border-radius: 8px; color: white; font-weight: 500; z-index: 1000; transform: translateX(120%); transition: transform 0.3s; }
        .toast.show { transform: translateX(0); }
        .toast-success { background: var(--success); }
        .toast-error { background: var(--danger); }
        
        .empty { text-align: center; padding: 2rem; color: var(--muted); }
        .search-bar { display: flex; gap: 0.5rem; margin-bottom: 1rem; }
        .search-bar input { flex: 1; }
        
        @media (max-width: 768px) {
            .container { padding: 1rem; }
            .form-grid { grid-template-columns: 1fr; }
            .tabs { gap: 0.3rem; }
            .tab { padding: 0.5rem 0.8rem; font-size: 0.85rem; }
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <h1>MediTrack</h1>
        <div class="stats" id="navStats">Loading...</div>
    </nav>

    <div class="container">
        <div class="stats-grid" id="dashboardStats"></div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('doctors')">Doctors</div>
            <div class="tab" onclick="switchTab('patients')">Patients</div>
            <div class="tab" onclick="switchTab('appointments')">Appointments</div>
            <div class="tab" onclick="switchTab('billing')">Billing</div>
            <div class="tab" onclick="switchTab('ai')">AI Recommend</div>
            <div class="tab" onclick="switchTab('data')">Data I/O</div>
        </div>

        <!-- DOCTORS PANEL -->
        <div class="panel active" id="panel-doctors">
            <div class="card">
                <h3>Add Doctor</h3>
                <div class="form-grid">
                    <div><label>Name</label><input id="doc-name" placeholder="Dr. Name"></div>
                    <div><label>Age</label><input id="doc-age" type="number" placeholder="35"></div>
                    <div><label>Gender</label>
                        <select id="doc-gender"><option value="Male">Male</option><option value="Female">Female</option><option value="Other">Other</option></select>
                    </div>
                    <div><label>Phone</label><input id="doc-phone" placeholder="1234567890"></div>
                    <div><label>Email</label><input id="doc-email" placeholder="dr@email.com"></div>
                    <div><label>Specialization</label>
                        <select id="doc-spec">
                            <option value="CARDIOLOGY">Cardiology</option><option value="DERMATOLOGY">Dermatology</option>
                            <option value="NEUROLOGY">Neurology</option><option value="ORTHOPEDICS">Orthopedics</option>
                            <option value="PEDIATRICS">Pediatrics</option><option value="GENERAL">General Medicine</option>
                            <option value="ENT">ENT</option><option value="OPHTHALMOLOGY">Ophthalmology</option>
                            <option value="PSYCHIATRY">Psychiatry</option><option value="GYNECOLOGY">Gynecology</option>
                        </select>
                    </div>
                    <div><label>Consultation Fee ($)</label><input id="doc-fee" type="number" placeholder="150"></div>
                    <div><label>Years of Experience</label><input id="doc-exp" type="number" placeholder="10"></div>
                </div>
                <div class="actions"><button class="btn btn-primary" onclick="addDoctor()">Add Doctor</button></div>
            </div>
            <div class="card">
                <h3>Doctors List</h3>
                <div class="search-bar">
                    <input id="doc-search" placeholder="Search by name, specialization...">
                    <button class="btn btn-primary" onclick="searchDoctors()">Search</button>
                    <button class="btn btn-warning" onclick="loadDoctors()">Refresh</button>
                </div>
                <div style="overflow-x:auto"><table><thead><tr><th>ID</th><th>Name</th><th>Specialization</th><th>Fee</th><th>Exp</th><th>Phone</th><th>Actions</th></tr></thead><tbody id="doc-table"></tbody></table></div>
            </div>
        </div>

        <!-- PATIENTS PANEL -->
        <div class="panel" id="panel-patients">
            <div class="card">
                <h3>Add Patient</h3>
                <div class="form-grid">
                    <div><label>Name</label><input id="pat-name" placeholder="Patient Name"></div>
                    <div><label>Age</label><input id="pat-age" type="number" placeholder="30"></div>
                    <div><label>Gender</label>
                        <select id="pat-gender"><option value="Male">Male</option><option value="Female">Female</option><option value="Other">Other</option></select>
                    </div>
                    <div><label>Phone</label><input id="pat-phone" placeholder="1234567890"></div>
                    <div><label>Email</label><input id="pat-email" placeholder="patient@email.com"></div>
                    <div><label>Blood Group</label>
                        <select id="pat-blood"><option value="A+">A+</option><option value="A-">A-</option><option value="B+">B+</option><option value="B-">B-</option><option value="O+">O+</option><option value="O-">O-</option><option value="AB+">AB+</option><option value="AB-">AB-</option></select>
                    </div>
                </div>
                <div class="actions"><button class="btn btn-primary" onclick="addPatient()">Add Patient</button></div>
            </div>
            <div class="card">
                <h3>Patients List</h3>
                <div class="search-bar">
                    <input id="pat-search" placeholder="Search by name, blood group...">
                    <button class="btn btn-primary" onclick="searchPatients()">Search</button>
                    <button class="btn btn-warning" onclick="loadPatients()">Refresh</button>
                </div>
                <div style="overflow-x:auto"><table><thead><tr><th>ID</th><th>Name</th><th>Age</th><th>Gender</th><th>Blood</th><th>Phone</th><th>Actions</th></tr></thead><tbody id="pat-table"></tbody></table></div>
            </div>
        </div>

        <!-- APPOINTMENTS PANEL -->
        <div class="panel" id="panel-appointments">
            <div class="card">
                <h3>Create Appointment</h3>
                <div class="form-grid">
                    <div><label>Doctor</label><select id="apt-doctor"></select></div>
                    <div><label>Patient</label><select id="apt-patient"></select></div>
                    <div><label>Date & Time</label><input id="apt-datetime" type="datetime-local"></div>
                    <div><label>Notes</label><input id="apt-notes" placeholder="Optional notes"></div>
                </div>
                <div class="actions"><button class="btn btn-primary" onclick="createAppointment()">Create Appointment</button></div>
            </div>
            <div class="card">
                <h3>Appointments List</h3>
                <button class="btn btn-warning btn-sm" onclick="loadAppointments()" style="margin-bottom:0.8rem">Refresh</button>
                <div style="overflow-x:auto"><table><thead><tr><th>ID</th><th>Doctor</th><th>Patient</th><th>Date/Time</th><th>Status</th><th>Actions</th></tr></thead><tbody id="apt-table"></tbody></table></div>
            </div>
        </div>

        <!-- BILLING PANEL -->
        <div class="panel" id="panel-billing">
            <div class="card">
                <h3>Generate Bill</h3>
                <div class="form-grid">
                    <div><label>Appointment</label><select id="bill-apt"></select></div>
                    <div><label>Bill Type</label>
                        <select id="bill-type"><option value="STANDARD">Standard</option><option value="INSURANCE">Insurance</option><option value="EMERGENCY">Emergency</option></select>
                    </div>
                </div>
                <div class="actions"><button class="btn btn-success" onclick="generateBill()">Generate Bill</button></div>
            </div>
            <div class="card">
                <h3>Bills List</h3>
                <button class="btn btn-warning btn-sm" onclick="loadBills()" style="margin-bottom:0.8rem">Refresh</button>
                <div style="overflow-x:auto"><table><thead><tr><th>ID</th><th>Patient</th><th>Doctor</th><th>Type</th><th>Fee</th><th>Tax</th><th>Discount</th><th>Total</th></tr></thead><tbody id="bill-table"></tbody></table></div>
            </div>
        </div>

        <!-- AI PANEL -->
        <div class="panel" id="panel-ai">
            <div class="card">
                <h3>AI Doctor Recommendation</h3>
                <p style="color:var(--muted);margin-bottom:1rem;font-size:0.9rem">Enter your symptoms and get doctor recommendations based on our rule-based AI engine.</p>
                <div class="form-grid">
                    <div style="grid-column:1/-1"><label>Symptoms</label><textarea id="ai-symptoms" rows="3" placeholder="e.g., headache, chest pain, skin rash, back pain..."></textarea></div>
                </div>
                <div class="actions"><button class="btn btn-primary" onclick="getRecommendations()">Get Recommendations</button></div>
            </div>
            <div class="card" id="ai-results" style="display:none">
                <h3>Recommended Doctors</h3>
                <div id="ai-doctors"></div>
            </div>
            <div class="card">
                <h3>Available Time Slots</h3>
                <div id="ai-slots"></div>
            </div>
        </div>

        <!-- DATA I/O PANEL -->
        <div class="panel" id="panel-data">
            <div class="card">
                <h3>CSV Data Persistence</h3>
                <p style="color:var(--muted);margin-bottom:1rem;font-size:0.9rem">Save current data to CSV files or load previously saved data. Demonstrates File I/O with try-with-resources.</p>
                <div class="actions">
                    <button class="btn btn-success" onclick="saveData()">Save All Data to CSV</button>
                    <button class="btn btn-primary" onclick="loadData()">Load Data from CSV</button>
                </div>
            </div>
            <div class="card">
                <h3>System Statistics</h3>
                <div id="system-stats"></div>
            </div>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        const API = '';

        // Toast notification
        function showToast(msg, type='success') {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.className = 'toast toast-' + type + ' show';
            setTimeout(() => t.classList.remove('show'), 3000);
        }

        async function api(path, opts={}) {
            try {
                const res = await fetch(API + path, { headers: {'Content-Type':'application/json'}, ...opts });
                if (!res.ok) { const err = await res.json().catch(()=>({})); throw new Error(err.message || res.statusText); }
                if (res.status === 204) return null;
                return await res.json();
            } catch(e) { showToast(e.message, 'error'); throw e; }
        }

        // Tab switching
        function switchTab(name) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('panel-' + name).classList.add('active');
            if (name === 'appointments') { populateDropdowns(); loadAppointments(); }
            if (name === 'billing') { populateBillDropdown(); loadBills(); }
            if (name === 'ai') loadSlots();
            if (name === 'data') loadStats();
        }

        // ===== DOCTORS =====
        async function addDoctor() {
            const doc = {
                name: document.getElementById('doc-name').value,
                age: parseInt(document.getElementById('doc-age').value),
                gender: document.getElementById('doc-gender').value,
                phone: document.getElementById('doc-phone').value,
                email: document.getElementById('doc-email').value,
                specialization: document.getElementById('doc-spec').value,
                consultationFee: parseFloat(document.getElementById('doc-fee').value),
                yearsOfExperience: parseInt(document.getElementById('doc-exp').value)
            };
            await api('/api/doctors', { method: 'POST', body: JSON.stringify(doc) });
            showToast('Doctor added successfully!');
            loadDoctors();
        }

        async function loadDoctors() {
            const docs = await api('/api/doctors');
            const tb = document.getElementById('doc-table');
            if (!docs.length) { tb.innerHTML = '<tr><td colspan="7" class="empty">No doctors found</td></tr>'; return; }
            tb.innerHTML = docs.map(d => `<tr>
                <td>${d.id}</td><td>${d.name}</td><td>${d.specialization}</td>
                <td>$${d.consultationFee?.toFixed(2)||'0.00'}</td><td>${d.yearsOfExperience||0} yrs</td><td>${d.phone||''}</td>
                <td><button class="btn btn-danger btn-sm" onclick="deleteDoctor('${d.id}')">Delete</button></td>
            </tr>`).join('');
            updateDashboard();
        }

        async function searchDoctors() {
            const kw = document.getElementById('doc-search').value;
            if (!kw) { loadDoctors(); return; }
            const docs = await api('/api/doctors/search?keyword=' + encodeURIComponent(kw));
            const tb = document.getElementById('doc-table');
            if (!docs.length) { tb.innerHTML = '<tr><td colspan="7" class="empty">No results</td></tr>'; return; }
            tb.innerHTML = docs.map(d => `<tr>
                <td>${d.id}</td><td>${d.name}</td><td>${d.specialization}</td>
                <td>$${d.consultationFee?.toFixed(2)||'0.00'}</td><td>${d.yearsOfExperience||0} yrs</td><td>${d.phone||''}</td>
                <td><button class="btn btn-danger btn-sm" onclick="deleteDoctor('${d.id}')">Delete</button></td>
            </tr>`).join('');
        }

        async function deleteDoctor(id) { await api('/api/doctors/' + id, { method: 'DELETE' }); showToast('Doctor deleted'); loadDoctors(); }

        // ===== PATIENTS =====
        async function addPatient() {
            const pat = {
                name: document.getElementById('pat-name').value,
                age: parseInt(document.getElementById('pat-age').value),
                gender: document.getElementById('pat-gender').value,
                phone: document.getElementById('pat-phone').value,
                email: document.getElementById('pat-email').value,
                bloodGroup: document.getElementById('pat-blood').value
            };
            await api('/api/patients', { method: 'POST', body: JSON.stringify(pat) });
            showToast('Patient added!');
            loadPatients();
        }

        async function loadPatients() {
            const pats = await api('/api/patients');
            const tb = document.getElementById('pat-table');
            if (!pats.length) { tb.innerHTML = '<tr><td colspan="7" class="empty">No patients found</td></tr>'; return; }
            tb.innerHTML = pats.map(p => `<tr>
                <td>${p.id}</td><td>${p.name}</td><td>${p.age}</td><td>${p.gender||''}</td><td>${p.bloodGroup||''}</td><td>${p.phone||''}</td>
                <td>
                    <button class="btn btn-primary btn-sm" onclick="clonePatient('${p.id}')">Clone</button>
                    <button class="btn btn-danger btn-sm" onclick="deletePatient('${p.id}')">Delete</button>
                </td>
            </tr>`).join('');
            updateDashboard();
        }

        async function searchPatients() {
            const kw = document.getElementById('pat-search').value;
            if (!kw) { loadPatients(); return; }
            const pats = await api('/api/patients/search?keyword=' + encodeURIComponent(kw));
            const tb = document.getElementById('pat-table');
            if (!pats.length) { tb.innerHTML = '<tr><td colspan="7" class="empty">No results</td></tr>'; return; }
            tb.innerHTML = pats.map(p => `<tr>
                <td>${p.id}</td><td>${p.name}</td><td>${p.age}</td><td>${p.gender||''}</td><td>${p.bloodGroup||''}</td><td>${p.phone||''}</td>
                <td><button class="btn btn-danger btn-sm" onclick="deletePatient('${p.id}')">Delete</button></td>
            </tr>`).join('');
        }

        async function clonePatient(id) { await api('/api/patients/' + id + '/clone', { method: 'POST' }); showToast('Patient cloned (deep copy)!'); loadPatients(); }
        async function deletePatient(id) { await api('/api/patients/' + id, { method: 'DELETE' }); showToast('Patient deleted'); loadPatients(); }

        // ===== APPOINTMENTS =====
        async function populateDropdowns() {
            const docs = await api('/api/doctors');
            const pats = await api('/api/patients');
            document.getElementById('apt-doctor').innerHTML = docs.map(d => `<option value="${d.id}">Dr. ${d.name} (${d.specialization})</option>`).join('');
            document.getElementById('apt-patient').innerHTML = pats.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
        }

        async function createAppointment() {
            const body = {
                doctorId: document.getElementById('apt-doctor').value,
                patientId: document.getElementById('apt-patient').value,
                dateTime: document.getElementById('apt-datetime').value + ':00',
                notes: document.getElementById('apt-notes').value
            };
            await api('/api/appointments', { method: 'POST', body: JSON.stringify(body) });
            showToast('Appointment created!');
            loadAppointments();
        }

        function statusBadge(s) {
            const cls = { CONFIRMED:'confirmed', PENDING:'pending', CANCELLED:'cancelled', COMPLETED:'completed' };
            return `<span class="badge badge-${cls[s]||'pending'}">${s}</span>`;
        }

        async function loadAppointments() {
            const apts = await api('/api/appointments');
            const tb = document.getElementById('apt-table');
            if (!apts.length) { tb.innerHTML = '<tr><td colspan="6" class="empty">No appointments</td></tr>'; return; }
            tb.innerHTML = apts.map(a => `<tr>
                <td>${a.id}</td><td>Dr. ${a.doctorName}</td><td>${a.patientName}</td>
                <td>${a.appointmentDateTime ? new Date(a.appointmentDateTime).toLocaleString() : 'N/A'}</td>
                <td>${statusBadge(a.status)}</td>
                <td>${a.status!=='CANCELLED' ? `<button class="btn btn-danger btn-sm" onclick="cancelApt('${a.id}')">Cancel</button>` : ''}</td>
            </tr>`).join('');
            updateDashboard();
        }

        async function cancelApt(id) { await api('/api/appointments/' + id + '/cancel', { method: 'PUT' }); showToast('Appointment cancelled'); loadAppointments(); }

        // ===== BILLING =====
        async function populateBillDropdown() {
            const apts = await api('/api/appointments');
            document.getElementById('bill-apt').innerHTML = apts
                .filter(a => a.status !== 'CANCELLED')
                .map(a => `<option value="${a.id}">${a.id} — ${a.patientName} with Dr. ${a.doctorName}</option>`).join('');
        }

        async function generateBill() {
            const body = {
                appointmentId: document.getElementById('bill-apt').value,
                billType: document.getElementById('bill-type').value
            };
            await api('/api/bills', { method: 'POST', body: JSON.stringify(body) });
            showToast('Bill generated!');
            loadBills();
        }

        async function loadBills() {
            const bills = await api('/api/bills');
            const tb = document.getElementById('bill-table');
            if (!bills.length) { tb.innerHTML = '<tr><td colspan="8" class="empty">No bills</td></tr>'; return; }
            tb.innerHTML = bills.map(b => `<tr>
                <td>${b.id}</td><td>${b.patientName}</td><td>${b.doctorName}</td><td>${b.billType}</td>
                <td>$${b.consultationFee?.toFixed(2)}</td><td>$${b.taxAmount?.toFixed(2)}</td>
                <td>$${b.discount?.toFixed(2)}</td><td><strong>$${b.totalAmount?.toFixed(2)}</strong></td>
            </tr>`).join('');
        }

        // ===== AI =====
        async function getRecommendations() {
            const symptoms = document.getElementById('ai-symptoms').value;
            if (!symptoms) { showToast('Please enter symptoms', 'error'); return; }
            const docs = await api('/api/ai/recommend?symptoms=' + encodeURIComponent(symptoms));
            const div = document.getElementById('ai-doctors');
            const panel = document.getElementById('ai-results');
            if (!docs.length) { panel.style.display='block'; div.innerHTML='<p class="empty">No doctors found for these symptoms. Try adding more doctors.</p>'; return; }
            panel.style.display = 'block';
            div.innerHTML = docs.map(d => `<div style="padding:0.5rem 0;border-bottom:1px solid var(--border)">
                <strong>Dr. ${d.name}</strong> — ${d.specialization} | Fee: $${d.consultationFee?.toFixed(2)} | ${d.yearsOfExperience} yrs exp
            </div>`).join('');
        }

        async function loadSlots() {
            const data = await api('/api/ai/slots');
            document.getElementById('ai-slots').innerHTML = data.availableSlots
                .map(s => `<span class="badge badge-confirmed" style="margin:0.2rem;display:inline-block">${s}</span>`).join('');
        }

        // ===== DATA I/O =====
        async function saveData() { const r = await api('/api/data/save', { method: 'POST' }); showToast(r.message); }
        async function loadData() { const r = await api('/api/data/load', { method: 'POST' }); showToast(r.message); loadDoctors(); loadPatients(); }

        async function loadStats() {
            const s = await api('/api/data/stats');
            document.getElementById('system-stats').innerHTML = `
                <p><strong>Total Entities Created (JVM):</strong> ${s.totalEntitiesCreated}</p>
                <p><strong>Doctors in Store:</strong> ${s.doctors}</p>
                <p><strong>Patients in Store:</strong> ${s.patients}</p>
                <p><strong>Appointments in Store:</strong> ${s.appointments}</p>
            `;
        }

        // ===== DASHBOARD =====
        async function updateDashboard() {
            try {
                const s = await api('/api/data/stats');
                document.getElementById('navStats').textContent = `Doctors: ${s.doctors} | Patients: ${s.patients} | Appointments: ${s.appointments}`;
                document.getElementById('dashboardStats').innerHTML = `
                    <div class="stat-card"><div class="number">${s.doctors}</div><div class="label">Doctors</div></div>
                    <div class="stat-card"><div class="number">${s.patients}</div><div class="label">Patients</div></div>
                    <div class="stat-card"><div class="number">${s.appointments}</div><div class="label">Appointments</div></div>
                    <div class="stat-card"><div class="number">${s.totalEntitiesCreated}</div><div class="label">Total Entities (JVM)</div></div>
                `;
            } catch(e) {}
        }

        // Init
        loadDoctors();
        loadPatients();
        updateDashboard();
    </script>
</body>
</html>
